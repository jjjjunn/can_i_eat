[supervisord]
nodaemon=true
logfile=/dev/stdout
logfile_maxbytes=0
loglevel=info
pidfile=/tmp/supervisord.pid

[program:fastapi]
command=uvicorn main:app --host 0.0.0.0 --port 8081 --log-level info --access-log --timeout-keep-alive 120
directory=/app
autostart=true
autorestart=true
startretries=3
startsecs=10
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0
environment=PYTHONUNBUFFERED=1,LOG_LEVEL=INFO
priority=100

[program:streamlit]
command=streamlit run app.py --server.port=8501 --server.headless=true --server.address=0.0.0.0 --server.maxUploadSize=10
directory=/app
autostart=true
autorestart=true
startretries=3
startsecs=10
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0
environment=PYTHONUNBUFFERED=1
priority=200

[program:nginx]
command=nginx -g 'daemon off;'
autostart=true
autorestart=true
startretries=3
startsecs=5
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0
priority=300